apiVersion: v1
kind: ConfigMap
metadata:
  name: release-name-apache-knox-helm-confmap
  labels:
    app: apache-knox-helm
    chart: apache-knox-helm-0.1.10
    release: release-name
    heritage: Helm
data:
  shared-providers-default-providers.json: |
    {
        "providers": [
            {
                "role": "authentication",
                "name": "ShiroProvider",
                "enabled": "true",
                "params": {
                    "sessionTimeout": "20",
                    "main.ldapRealm": "org.apache.knox.gateway.shirorealm.KnoxLdapRealm",
                    "main.ldapContextFactory": "org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory",
                    "main.ldapRealm.contextFactory": "$ldapContextFactory",
                    "main.ldapRealm.userDnTemplate": "uid={0},ou=people,dc=hadoop,dc=apache,dc=org",
                    "main.ldapRealm.contextFactory.url": "ldap://localhost:33389",
                    "main.ldapRealm.contextFactory.authenticationMechanism": "simple",
                    "urls./**": "authcBasic"
                }
            }
        ]
    }
  topologies-sandbox.xml: "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<topology>\n\n    <gateway>\n        <provider>\n            <role>authentication</role>\n            <name>ShiroProvider</name>\n            <enabled>true</enabled>\n            <param>\n                <!-- \n                session timeout in minutes,  this is really idle timeout,\n                defaults to 30mins, if the property value is not defined,, \n                current client authentication would expire if client idles contiuosly for more than this value\n                -->\n                <name>sessionTimeout</name>\n                <value>30</value>\n            </param>\n            <param>\n                <name>main.ldapRealm</name>\n                <value>org.apache.knox.gateway.shirorealm.KnoxLdapRealm</value>\n            </param>\n            <param>\n                <name>main.ldapContextFactory</name>\n                <value>org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.contextFactory</name>\n                <value>$ldapContextFactory</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.userDnTemplate</name>\n                <value>uid={0},ou=people,dc=hadoop,dc=apache,dc=org</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.contextFactory.url</name>\n                <value>ldap://localhost:33389</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.contextFactory.authenticationMechanism</name>\n                <value>simple</value>\n            </param>\n            <param>\n                <name>urls./**</name>\n                <value>authcBasic</value>\n            </param>\n        </provider>\n\n        <provider>\n            <role>authorization</role>\n            <name>AclsAuthz</name>\n            <enabled>true</enabled>\n            <param>\n                <name>knox.acl</name>\n                <value>admin;*;*</value>\n            </param>\n        </provider>\n\n        <provider>\n            <role>identity-assertion</role>\n            <name>Default</name>\n            <enabled>true</enabled>\n        </provider>\n    </gateway>\n\n    <service>\n        <role>NAMENODE</role>\n        <url>hdfs://nn:9000/webhdfs</url> <!-- e.g. hdfs://hadoop-demo-name-node:9000/webhdfs -->\n    </service>\n\n    <service>\n        <role>RESOURCEMANAGER</role>\n        <url>http://rm:8088/ws</url> <!-- e.g. http://hadoop-demo-yarn-rm:8088/ws -->\n    </service>\n    \n    <service>\n        <role>WEBHDFS</role>\n        <url>http://nn:50070/webhdfs</url> <!-- e.g. http://hadoop-demo-name-node:50070/webhdfs -->\n    </service>\n\n    <service>\n        <role>HDFSUI</role>\n        <url>http://nn:50070/</url> <!-- e.g. http://sandbox.hortonworks.com:50070 -->\n        \n        <!-- cf. https://issues.apache.org/jira/browse/KNOX-1644 and https://community.cloudera.com/t5/Support-Questions/HDP-3-1-0-Knox-proxy-HDFSUI-HTTP-401-Error/m-p/240282 -->\n        <version>2.7.0</version> \n    </service>\n\n    <!-- TODO: Find currect URL of the jobtracker\n            The RPC address at which the Resource Manager exposes the JOBTRACKER endpoint can be found via the yarn.resourcemanager.address in the yarn-site.xml file. In a Sandbox installation this can typically be found in /etc/hadoop/conf/yarn-site.xml.\n    <service>\n        <role>JOBTRACKER</role>\n        <url>rpc://localhost:8050</url>\n    </service>\n    -->\n\n    <!-- TODO:\n    <service>\n        <role>JOBHISTORYUI</role>\n        <url>http://sandbox.hortonworks.com:19888</url>\n    </service>\n    -->\n\n    <service>\n        <role>YARNUI</role>\n         <url>http://yarn-ui:8088</url> <!-- e.g. http://sandbox.hortonworks.com:8088 -->\n    </service>\n\n    <!-- New in 1.1.4\n    <service>\n        <role>WEBHCAT</role>\n        <url>http://localhost:50111/templeton</url>\n    </service>\n\n    <service>\n        <role>OOZIE</role>\n        <url>http://localhost:11000/oozie</url>\n        <param>\n            <name>replayBufferSize</name>\n            <value>8</value>\n        </param>\n    </service>\n\n    <service>\n        <role>WEBHBASE</role>\n        <url>http://localhost:60080</url>\n        <param>\n            <name>replayBufferSize</name>\n            <value>8</value>\n        </param>\n    </service>\n\n    <service>\n        <role>HIVE</role>\n        <url>http://localhost:10001/cliservice</url>\n        <param>\n            <name>replayBufferSize</name>\n            <value>8</value>\n        </param>\n    </service>\n\n    <service>\n        <role>DRUID-COORDINATOR-UI</role>\n        <url>http://localhost:8081</url>\n    </service>\n\n    <service>\n        <role>DRUID-COORDINATOR</role>\n        <url>http://localhost:8081</url>\n    </service>\n\n    <service>\n        <role>DRUID-BROKER</role>\n        <url>http://localhost:8082</url>\n    </service>\n\n    <service>\n        <role>DRUID-ROUTER</role>\n        <url>http://localhost:8082</url>\n    </service>\n    \n    <service>\n        <role>DRUID-OVERLORD</role>\n        <url>http://localhost:8090</url>\n    </service>\n\n    <service>\n        <role>DRUID-OVERLORD-UI</role>\n        <url>http://localhost:8090</url>\n    </service>\n\n    <service>\n        <role>HUE</role>\n        <url>http://localhost:8889</url>\n    </service>\n-->\n</topology>\n"
  topologies-homepage.xml: |
    <?xml version="1.0" encoding="UTF-8"?>
    <!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
    -->
    <topology>
        <name>homepage</name>
        <gateway>
            <provider>
                <role>webappsec</role>
                <name>WebAppSec</name>
                <enabled>true</enabled>
                <param>
                    <name>csrf.enabled</name>
                    <value>true</value>
                </param>
                <param>
                    <name>csrf.customHeader</name>
                    <value>X-XSRF-Header</value>
                </param>
                <param>
                    <name>csrf.methodsToIgnore</name>
                    <value>GET,OPTIONS,HEAD</value>
                </param>
                <param>
                    <name>xframe.options.enabled</name>
                    <value>true</value>
                </param>
                <param>
                    <name>xss.protection.enabled</name>
                    <value>true</value>
                </param>
                <param>
                    <name>strict.transport.enabled</name>
                    <value>false</value>
                </param>
            </provider>
            <provider>
                <role>federation</role>
                <name>SSOCookieProvider</name>
                <enabled>true</enabled>
            </provider>
        </gateway>
        <service>
            <role>KNOX-METADATA</role>
        </service>
        <application>
            <name>home</name>
        </application>
    </topology>
  topologies-metadata.xml: |
    <?xml version="1.0" encoding="utf-8"?>
    <!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
    -->
    <topology>

        <gateway>
            <provider>
                <role>authentication</role>
                <name>ShiroProvider</name>
                <enabled>true</enabled>
                <param>
                    <name>sessionTimeout</name>
                    <value>30</value>
                </param>
                <param>
                    <name>main.ldapRealm</name>
                    <value>org.apache.knox.gateway.shirorealm.KnoxLdapRealm</value>
                </param>
                <param>
                    <name>main.ldapContextFactory</name>
                    <value>org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory</value>
                </param>
                <param>
                    <name>main.ldapRealm.contextFactory</name>
                    <value>$ldapContextFactory</value>
                </param>
                <param>
                    <name>main.ldapRealm.userDnTemplate</name>
                    <value>uid={0},ou=people,dc=hadoop,dc=apache,dc=org</value>
                </param>
                <param>
                    <name>main.ldapRealm.contextFactory.url</name>
                    <value>ldap://localhost:33389</value>
                </param>
                <param>
                    <name>main.ldapRealm.contextFactory.authenticationMechanism</name>
                    <value>simple</value>
                </param>
                <param>
                    <name>urls./**</name>
                    <value>authcBasic</value>
                </param>
            </provider>
        </gateway>

        <service>
            <role>KNOX-METADATA</role>
        </service>

    </topology>
  topologies-admin.xml: "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!--\nLicensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the \"License\"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n-->\n<topology>\n\n    <gateway>\n\n        <provider>\n            <role>authentication</role>\n            <name>ShiroProvider</name>\n            <enabled>true</enabled>\n            <param>\n                <!-- \n                session timeout in minutes,  this is really idle timeout,\n                defaults to 30mins, if the property value is not defined,, \n                current client authentication would expire if client idles contiuosly for more than this value\n                -->\n                <name>sessionTimeout</name>\n                <value>30</value>\n            </param>\n            <param>\n                <name>main.ldapRealm</name>\n                <value>org.apache.knox.gateway.shirorealm.KnoxLdapRealm</value>\n            </param>\n            <param>\n                <name>main.ldapContextFactory</name>\n                <value>org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.contextFactory</name>\n                <value>$ldapContextFactory</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.userDnTemplate</name>\n                <value>uid={0},ou=people,dc=hadoop,dc=apache,dc=org</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.contextFactory.url</name>\n                <value>ldap://localhost:33389</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.contextFactory.authenticationMechanism</name>\n                <value>simple</value>\n            </param>\n            <param>\n                <name>urls./**</name>\n                <value>authcBasic</value>\n            </param>\n        </provider>\n\n        <provider>\n            <role>authorization</role>\n            <name>AclsAuthz</name>\n            <enabled>true</enabled>\n            <param>\n                <name>knox.acl</name>\n                <value>*;*;*</value>\n            </param>\n        </provider>\n\n        <provider>\n            <role>identity-assertion</role>\n            <name>Default</name>\n            <enabled>true</enabled>\n        </provider>\n\n        <provider>\n            <role>hostmap</role>\n            <name>static</name>\n            <enabled>true</enabled>\n            <param>\n                <name>localhost</name>\n                <value>sandbox,sandbox.hortonworks.com</value>\n            </param>\n        </provider>\n\n    </gateway>\n\n    <service>\n        <role>KNOX</role>\n    </service>\n\n</topology>\n"
  topologies-knoxsso.xml: "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!--\nLicensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the \"License\"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n-->\n<topology>\n    <gateway>\n    <provider>\n        <role>webappsec</role>\n        <name>WebAppSec</name>\n        <enabled>true</enabled>\n        <param><name>xframe.options.enabled</name><value>true</value></param>\n    </provider>\n\n        <provider>\n            <role>authentication</role>\n            <name>ShiroProvider</name>\n            <enabled>true</enabled>\n            <param>\n                <!-- \n                session timeout in minutes,  this is really idle timeout,\n                defaults to 30mins, if the property value is not defined,, \n                current client authentication would expire if client idles contiuosly for more than this value\n                -->\n                <name>sessionTimeout</name>\n                <value>30</value>\n            </param>\n            <param>\n                <name>redirectToUrl</name>\n                <value>/${GATEWAY_PATH}/knoxsso/knoxauth/login.html</value>\n            </param>\n            <param>\n                <name>restrictedCookies</name>\n                <value>rememberme,WWW-Authenticate</value>\n            </param>\n            <param>\n                <name>main.ldapRealm</name>\n                <value>org.apache.knox.gateway.shirorealm.KnoxLdapRealm</value>\n            </param>\n            <param>\n                <name>main.ldapContextFactory</name>\n                <value>org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.contextFactory</name>\n                <value>$ldapContextFactory</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.userDnTemplate</name>\n                <value>uid={0},ou=people,dc=hadoop,dc=apache,dc=org</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.contextFactory.url</name>\n                <value>ldap://localhost:33389</value>\n            </param>    \n            <param>\n                <name>main.ldapRealm.authenticationCachingEnabled</name>\n                <value>false</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.contextFactory.authenticationMechanism</name>\n                <value>simple</value>\n            </param>\n            <param>\n                <name>urls./**</name>\n                <value>authcBasic</value>\n            </param>\n        </provider>\n\n        <provider>\n            <role>identity-assertion</role>\n            <name>Default</name>\n            <enabled>true</enabled>\n        </provider>\n\n        <provider>\n            <role>hostmap</role>\n            <name>static</name>\n            <enabled>true</enabled>\n            <param>\n                <name>localhost</name>\n                <value>sandbox,sandbox.hortonworks.com</value>\n            </param>\n        </provider>\n\n    </gateway>\n\n    <application>\n    <name>knoxauth</name>\n    </application>\n\n    <service>\n        <role>KNOXSSO</role>\n        <param>\n            <name>knoxsso.cookie.secure.only</name>\n            <value>true</value>\n        </param>\n        <param>\n            <!-- 24 hours in milliseconds = 86400000 -->\n            <name>knoxsso.token.ttl</name>\n            <value>86400000</value>\n        </param>\n        <param>\n          <name>knoxsso.redirect.whitelist.regex</name>\n          <value>.*</value>\n          <!-- <value>^https?:\\/\\/(localhost|127\\.0\\.0\\.1|0:0:0:0:0:0:0:1|::1):[0-9].*$</value> -->\n        </param>\n    </service>\n\n</topology>  \n"
  topologies-manager.xml: "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!--\nLicensed to the Apache Software Foundation (ASF) under one or more\ncontributor license agreements.  See the NOTICE file distributed with\nthis work for additional information regarding copyright ownership.\nThe ASF licenses this file to You under the Apache License, Version 2.0\n(the \"License\"); you may not use this file except in compliance with\nthe License.  You may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n-->\n<topology>\n    <name>manager</name>\n    <gateway>\n        <provider>\n            <role>webappsec</role>\n            <name>WebAppSec</name>\n            <enabled>true</enabled>\n            <param><name>csrf.enabled</name><value>true</value></param>\n            <param><name>csrf.customHeader</name><value>X-XSRF-Header</value></param>\n            <param><name>csrf.methodsToIgnore</name><value>GET,OPTIONS,HEAD</value></param>\n            <param><name>xframe.options.enabled</name><value>true</value></param>\n            <param><name>xss.protection.enabled</name><value>true</value></param>\n            <param><name>strict.transport.enabled</name><value>false</value></param>\n        </provider>\n        \n     \n        <provider>\n            <role>authentication</role>\n            <name>ShiroProvider</name>\n            <enabled>true</enabled>\n            <param>\n                <name>sessionTimeout</name>\n                <value>30</value>\n            </param>\n            <param>\n                <name>main.ldapRealm</name>\n                <value>org.apache.knox.gateway.shirorealm.KnoxLdapRealm</value>\n            </param>\n            <param>\n                <name>main.ldapContextFactory</name>\n                <value>org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.contextFactory</name>\n                <value>$ldapContextFactory</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.userDnTemplate</name>\n                <value>uid={0},ou=people,dc=hadoop,dc=apache,dc=org</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.contextFactory.url</name>\n                <value>ldap://localhost:33389</value>\n            </param>\n            <param>\n                <name>main.ldapRealm.contextFactory.authenticationMechanism</name>\n                <value>simple</value>\n            </param>\n            <param>\n                <name>urls./**</name>\n                <value>authcBasic</value>\n            </param>\n        </provider>\n\n        <provider>\n            <role>authorization</role>\n            <name>AclsAuthz</name>\n            <enabled>true</enabled>\n            <param>\n                <name>knox.acl.mode</name>\n                <value>OR</value>\n            </param>\n\n            <param>\n                <name>knox.acl</name>\n                <value>admin;*;*</value>\n            </param>\n        </provider>\n\n        <provider>\n            <role>identity-assertion</role>\n            <name>Default</name>\n            <enabled>true</enabled>\n        </provider>\n\n    <!-- 1.1.3 only -->\n      <provider>\n            <role>hostmap</role>\n            <name>static</name>\n            <enabled>true</enabled>\n            <param>\n                <name>localhost</name>\n                <value>sandbox,sandbox.hortonworks.com</value>\n            </param>\n        </provider>\n    \n    </gateway>\n    \n    <service>\n        <role>KNOX</role>\n    </service>\n\n    <application>\n        <name>admin-ui</name>\n    </application>\n\n</topology>\n"
  gateway-log4j.properties: |
    # Licensed to the Apache Software Foundation (ASF) under one
    # or more contributor license agreements.  See the NOTICE file
    # distributed with this work for additional information
    # regarding copyright ownership.  The ASF licenses this file
    # to you under the Apache License, Version 2.0 (the
    # "License"); you may not use this file except in compliance
    # with the License.  You may obtain a copy of the License at
    #
    #     http://www.apache.org/licenses/LICENSE-2.0
    #
    # Unless required by applicable law or agreed to in writing, software
    # distributed under the License is distributed on an "AS IS" BASIS,
    # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    # See the License for the specific language governing permissions and
    # limitations under the License.

    app.log.dir=${launcher.dir}/../logs
    app.log.file=${launcher.name}.log
    app.audit.file=${launcher.name}-audit.log

    log4j.rootLogger=INFO, drfa

     log4j.logger.org.apache.knox.gateway=DEBUG

    #log4j.logger.org.eclipse.jetty=DEBUG
    #log4j.logger.org.apache.shiro=DEBUG
    #log4j.logger.org.apache.http=DEBUG
    #log4j.logger.org.apache.http.client=DEBUG
    #log4j.logger.org.apache.http.headers=DEBUG
    #log4j.logger.org.apache.http.wire=DEBUG

    log4j.appender.stdout=org.apache.log4j.ConsoleAppender
    log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
    log4j.appender.stdout.layout.ConversionPattern=%d{yy/MM/dd HH:mm:ss} %p %c{2}: %m%n

    log4j.appender.drfa=org.apache.log4j.DailyRollingFileAppender
    log4j.appender.drfa.File=${app.log.dir}/${app.log.file}
    log4j.appender.drfa.DatePattern=.yyyy-MM-dd
    log4j.appender.drfa.layout=org.apache.log4j.PatternLayout
    log4j.appender.drfa.layout.ConversionPattern=%d{ISO8601} %-5p %c{2} (%F:%M(%L)) - %m%n

    log4j.logger.audit=DEBUG, auditfile
    log4j.appender.auditfile=org.apache.log4j.DailyRollingFileAppender
    log4j.appender.auditfile.File=${app.log.dir}/${app.audit.file}
    log4j.appender.auditfile.Append = true
    log4j.appender.auditfile.DatePattern = '.'yyyy-MM-dd
    log4j.appender.auditfile.layout = org.apache.knox.gateway.audit.log4j.layout.AuditLayout

    #log4j.logger.org.apache.knox.gateway.access=TRACE,httpaccess
    #log4j.additivity.org.apache.knox.gateway.access=false

    #log4j.logger.org.apache.knox.gateway.http=TRACE,httpserver
    #log4j.additivity.org.apache.knox.gateway.http=false
    ##log4j.logger.org.apache.knox.gateway.http.request.headers=OFF
    ##log4j.logger.org.apache.knox.gateway.http.response.headers=OFF
    ##log4j.logger.org.apache.knox.gateway.http.request.body=OFF
    ##log4j.logger.org.apache.knox.gateway.http.response.body=OFF

    #log4j.logger.org.apache.http.wire=DEBUG,httpclient
    #log4j.additivity.org.apache.http.wire=false

    #log4j.appender.httpaccess=org.apache.log4j.DailyRollingFileAppender
    #log4j.appender.httpaccess.File=${app.log.dir}/${launcher.name}-http-access.log
    #log4j.appender.httpaccess.DatePattern=.yyyy-MM-dd
    #log4j.appender.httpaccess.layout=org.apache.log4j.PatternLayout
    #log4j.appender.httpaccess.layout.ConversionPattern=%d{ISO8601}|%t|%m%n

    #log4j.appender.httpserver=org.apache.log4j.DailyRollingFileAppender
    #log4j.appender.httpserver.File=${app.log.dir}/${launcher.name}-http-server.log
    #log4j.appender.httpserver.DatePattern=.yyyy-MM-dd
    #log4j.appender.httpserver.layout=org.apache.log4j.PatternLayout
    #log4j.appender.httpserver.layout.ConversionPattern=%d{ISO8601}|%t|%m%n

    #log4j.appender.httpclient=org.apache.log4j.DailyRollingFileAppender
    #log4j.appender.httpclient.File=${app.log.dir}/${launcher.name}-http-client.log
    #log4j.appender.httpclient.DatePattern=.yyyy-MM-dd
    #log4j.appender.httpclient.layout=org.apache.log4j.PatternLayout
    #log4j.appender.httpclient.layout.ConversionPattern=%d{ISO8601}|%t|%m%n

    # Apache Shiro Related logging - KNOX-757
    #log4j.logger.org.springframework=DEBUG
    #log4j.logger.net.sf.ehcache=DEBUG
    #log4j.logger.org.apache.shiro.util.ThreadContext=DEBUG
  gateway-site.xml: |
    <?xml version="1.0" encoding="UTF-8"?>
    <!--
    Licensed to the Apache Software Foundation (ASF) under one
    or more contributor license agreements.  See the NOTICE file
    distributed with this work for additional information
    regarding copyright ownership.  The ASF licenses this file
    to you under the Apache License, Version 2.0 (the
    "License"); you may not use this file except in compliance
    with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
    -->
    <configuration>

        <property>
            <name>gateway.port</name>
            <value>8080</value>
            <description>The HTTP port for the Gateway.</description>
        </property>

        <property>
            <name>gateway.path</name>
            <value>gateway</value>
            <description>The default context path for the gateway.</description>
        </property>

        <property>
            <name>default.app.topology.name</name>
             <value>sandbox</value>
        </property>

        <property>
            <name>ssl.enabled</name>
            <value>false</value>
        </property>

        <property>
            <name>gateway.gateway.conf.dir</name>
            <value>deployments</value>
            <description>The directory within GATEWAY_HOME that contains gateway topology files and deployments.</description>
        </property>

        <property>
            <name>gateway.hadoop.kerberos.secured</name>
            <value>false</value>
            <description>Boolean flag indicating whether the Hadoop cluster protected by Gateway is secured with Kerberos</description>
        </property>

        <property>
            <name>java.security.krb5.conf</name>
            <value>/etc/knox/conf/krb5.conf</value>
            <description>Absolute path to krb5.conf file</description>
        </property>

        <property>
            <name>java.security.auth.login.config</name>
            <value>/etc/knox/conf/krb5JAASLogin.conf</value>
            <description>Absolute path to JAAS login config file</description>
        </property>

        <property>
            <name>sun.security.krb5.debug</name>
            <value>true</value>
            <description>Boolean flag indicating whether to enable debug messages for krb5 authentication</description>
        </property>

        <!-- @since 0.10 Websocket configs -->
        <property>
            <name>gateway.websocket.feature.enabled</name>
            <value>false</value>
            <description>Enable/Disable websocket feature.</description>
        </property>

        <property>
            <name>gateway.scope.cookies.feature.enabled</name>
            <value>false</value>
            <description>Enable/Disable cookie scoping feature.</description>
        </property>

        <property>
            <name>gateway.cluster.config.monitor.ambari.enabled</name>
            <value>false</value>
            <description>Enable/disable Ambari cluster configuration monitoring.</description>
        </property>

        <property>
            <name>gateway.cluster.config.monitor.ambari.interval</name>
            <value>60</value>
            <description>The interval (in seconds) for polling Ambari for cluster configuration changes.</description>
        </property>

        <!-- Knox Admin related config (new in 1.1.4) -->
        <property>
            <name>gateway.knox.admin.groups</name>
            <value>admin</value>
        </property>

        <!-- DEMO LDAP config for Hadoop Group Provider -->
        <property>
            <name>gateway.group.config.hadoop.security.group.mapping</name>
            <value>org.apache.hadoop.security.LdapGroupsMapping</value>
        </property>
        <property>
            <name>gateway.group.config.hadoop.security.group.mapping.ldap.bind.user</name>
            <value>uid=guest,ou=people,dc=hadoop,dc=apache,dc=org</value>
        </property>
        <property>
            <name>gateway.group.config.hadoop.security.group.mapping.ldap.bind.password</name>
            <value>guest-password</value>
        </property>
        <property>
            <name>gateway.group.config.hadoop.security.group.mapping.ldap.url</name>
            <value>ldap://localhost:33389</value>
        </property>
        <property>
            <name>gateway.group.config.hadoop.security.group.mapping.ldap.base</name>
            <value></value>
        </property>
        <property>
            <name>gateway.group.config.hadoop.security.group.mapping.ldap.search.filter.user</name>
            <value>(&amp;(|(objectclass=person)(objectclass=applicationProcess))(cn={0}))</value>
        </property>
        <property>
            <name>gateway.group.config.hadoop.security.group.mapping.ldap.search.filter.group</name>
            <value>(objectclass=groupOfNames)</value>
        </property>
        <property>
            <name>hgateway.group.config.adoop.security.group.mapping.ldap.search.attr.member</name>
            <value>member</value>
        </property>
        <property>
            <name>gateway.group.config.hadoop.security.group.mapping.ldap.search.attr.group.name</name>
            <value>cn</value>
        </property>
        <property>
            <name>gateway.dispatch.whitelist.services</name>
            <value>DATANODE,HBASEUI,HDFSUI,JOBHISTORYUI,NODEUI,YARNUI,knoxauth</value>
            <description>The comma-delimited list of service roles for which the gateway.dispatch.whitelist should be applied.</description>
        </property>
        <property>
            <name>gateway.dispatch.whitelist</name>
            <!-- <value>^https?:\/\/(localhost|127\.0\.0\.1|0:0:0:0:0:0:0:1|::1):[0-9].*$</value> -->
            <value>.*</value>
            <description>The whitelist to be applied for dispatches associated with the service roles specified by gateway.dispatch.whitelist.services.
            If the value is DEFAULT, a domain-based whitelist will be derived from the Knox host.</description>
        </property>
        <property>
            <name>gateway.xforwarded.header.context.append.servicename</name>
            <value>LIVYSERVER</value>
            <description>Add service name to x-forward-context header for the list of services defined above.</description>
        </property>
       <!-- END: Knox Admin related config (new in 1.1.4) -->


    </configuration>
  knoxcli-log4j.properties: |
    # Licensed to the Apache Software Foundation (ASF) under one
    # or more contributor license agreements.  See the NOTICE file
    # distributed with this work for additional information
    # regarding copyright ownership.  The ASF licenses this file
    # to you under the Apache License, Version 2.0 (the
    # "License"); you may not use this file except in compliance
    # with the License.  You may obtain a copy of the License at
    #
    #     http://www.apache.org/licenses/LICENSE-2.0
    #
    # Unless required by applicable law or agreed to in writing, software
    # distributed under the License is distributed on an "AS IS" BASIS,
    # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    # See the License for the specific language governing permissions and
    # limitations under the License.

    app.log.dir=${launcher.dir}/../logs
    app.log.file=${launcher.name}.log

    log4j.rootLogger=INFO, drfa

    log4j.logger.org.apache.knox.gateway=DEBUG
    #log4j.logger.org.apache.knox.gateway=ALL

    log4j.appender.stdout=org.apache.log4j.ConsoleAppender
    log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
    log4j.appender.stdout.layout.ConversionPattern=%d{yy/MM/dd HH:mm:ss} %p %c{2}: %m%n

    log4j.appender.drfa=org.apache.log4j.DailyRollingFileAppender
    log4j.appender.drfa.File=${app.log.dir}/${app.log.file}
    log4j.appender.drfa.DatePattern=.yyyy-MM-dd
    log4j.appender.drfa.layout=org.apache.log4j.PatternLayout
    log4j.appender.drfa.layout.ConversionPattern=%d{ISO8601} %-5p %c{2} (%F:%M(%L)) - %m%n
  ldap-log4j.properties: "# Licensed to the Apache Software Foundation (ASF) under one\n# or more contributor license agreements.  See the NOTICE file\n# distributed with this work for additional information\n# regarding copyright ownership.  The ASF licenses this file\n# to you under the Apache License, Version 2.0 (the\n# \"License\"); you may not use this file except in compliance\n# with the License.  You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\napp.log.dir=${launcher.dir}/../logs\napp.log.file=${launcher.name}.log\n\nlog4j.rootLogger=INFO, drfa\nlog4j.logger.org.apache.directory.server.ldap.LdapServer=INFO\nlog4j.logger.org.apache.directory=INFO\n\nlog4j.appender.stdout=org.apache.log4j.ConsoleAppender\nlog4j.appender.stdout.layout=org.apache.log4j.PatternLayout\nlog4j.appender.stdout.layout.ConversionPattern=%d{yy/MM/dd HH:mm:ss} %p %c{2}: %m%n\n\nlog4j.appender.drfa=org.apache.log4j.DailyRollingFileAppender\nlog4j.appender.drfa.File=${app.log.dir}/${app.log.file}\nlog4j.appender.drfa.DatePattern=.yyyy-MM-dd\nlog4j.appender.drfa.layout=org.apache.log4j.PatternLayout\nlog4j.appender.drfa.layout.ConversionPattern=%d{ISO8601} %-5p %c{2} (%F:%M(%L)) - %m%n    \n"
  shell-log4j.properties: |
    # Licensed to the Apache Software Foundation (ASF) under one
    # or more contributor license agreements.  See the NOTICE file
    # distributed with this work for additional information
    # regarding copyright ownership.  The ASF licenses this file
    # to you under the Apache License, Version 2.0 (the
    # "License"); you may not use this file except in compliance
    # with the License.  You may obtain a copy of the License at
    #
    #     http://www.apache.org/licenses/LICENSE-2.0
    #
    # Unless required by applicable law or agreed to in writing, software
    # distributed under the License is distributed on an "AS IS" BASIS,
    # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    # See the License for the specific language governing permissions and
    # limitations under the License.

    app.log.dir=${launcher.dir}/../logs
    app.log.file=${launcher.name}.log

    log4j.rootLogger=INFO, drfa

    #log4j.logger.org.apache.http.wire=DEBUG

    log4j.appender.stdout=org.apache.log4j.ConsoleAppender
    log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
    log4j.appender.stdout.layout.ConversionPattern=%d{yy/MM/dd HH:mm:ss} %p %c{2}: %m%n

    log4j.appender.drfa=org.apache.log4j.DailyRollingFileAppender
    log4j.appender.drfa.File=${app.log.dir}/${app.log.file}
    log4j.appender.drfa.DatePattern=.yyyy-MM-dd
    log4j.appender.drfa.layout=org.apache.log4j.PatternLayout
    log4j.appender.drfa.layout.ConversionPattern=%d{ISO8601} %-5p %c{2} (%F:%M(%L)) - %m%n
  users.ldif: |
    # Licensed to the Apache Software Foundation (ASF) under one
    # or more contributor license agreements.  See the NOTICE file
    # distributed with this work for additional information
    # regarding copyright ownership.  The ASF licenses this file
    # to you under the Apache License, Version 2.0 (the
    # "License"); you may not use this file except in compliance
    # with the License.  You may obtain a copy of the License at
    #
    #     http://www.apache.org/licenses/LICENSE-2.0
    #
    # Unless required by applicable law or agreed to in writing, software
    # distributed under the License is distributed on an "AS IS" BASIS,
    # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    # See the License for the specific language governing permissions and
    # limitations under the License.

    version: 1

    # Please replace with site specific values
    dn: dc=hadoop,dc=apache,dc=org
    objectclass: organization
    objectclass: dcObject
    o: Hadoop
    dc: hadoop

    # Entry for a sample people container
    # Please replace with site specific values
    dn: ou=people,dc=hadoop,dc=apache,dc=org
    objectclass:top
    objectclass:organizationalUnit
    ou: people

    # Entry for a sample end user
    # Please replace with site specific values
    dn: uid=guest,ou=people,dc=hadoop,dc=apache,dc=org
    objectclass:top
    objectclass:person
    objectclass:organizationalPerson
    objectclass:inetOrgPerson
    cn: Guest
    sn: User
    uid: guest
    userPassword:guest-password

    # entry for sample user admin
    dn: uid=admin,ou=people,dc=hadoop,dc=apache,dc=org
    objectclass:top
    objectclass:person
    objectclass:organizationalPerson
    objectclass:inetOrgPerson
    cn: Admin
    sn: Admin
    uid: admin
    userPassword:admin-password

    # entry for sample user root
    dn: uid=root,ou=people,dc=hadoop,dc=apache,dc=org
    objectclass:top
    objectclass:person
    objectclass:organizationalPerson
    objectclass:inetOrgPerson
    cn: Root
    sn: Root
    uid: root
    userPassword:root-password

    # entry for sample user sam
    dn: uid=sam,ou=people,dc=hadoop,dc=apache,dc=org
    objectclass:top
    objectclass:person
    objectclass:organizationalPerson
    objectclass:inetOrgPerson
    cn: sam
    sn: sam
    uid: sam
    userPassword:sam-password

    # entry for sample user tom
    dn: uid=tom,ou=people,dc=hadoop,dc=apache,dc=org
    objectclass:top
    objectclass:person
    objectclass:organizationalPerson
    objectclass:inetOrgPerson
    cn: tom
    sn: tom
    uid: tom
    userPassword:tom-password

    # create FIRST Level groups branch
    dn: ou=groups,dc=hadoop,dc=apache,dc=org
    objectclass:top
    objectclass:organizationalUnit
    ou: groups
    description: generic groups branch

    # create the analyst group under groups
    dn: cn=analyst,ou=groups,dc=hadoop,dc=apache,dc=org
    objectclass:top
    objectclass: groupofnames
    cn: analyst
    description:analyst  group
    member: uid=sam,ou=people,dc=hadoop,dc=apache,dc=org
    member: uid=tom,ou=people,dc=hadoop,dc=apache,dc=org

    # create the scientist group under groups
    dn: cn=scientist,ou=groups,dc=hadoop,dc=apache,dc=org
    objectclass:top
    objectclass: groupofnames
    cn: scientist
    description: scientist group
    member: uid=sam,ou=people,dc=hadoop,dc=apache,dc=org
  descriptors-README: |
    THIS DIRECTORY IS WHERE SIMPLE TOPOLOGY DESCRIPTORS CAN BE PLACED
---
apiVersion: v1
kind: Service
metadata:
  name: release-name-apache-knox-helm-svc
  labels:
    app: apache-knox-helm
    chart: apache-knox-helm-0.1.10
    release: release-name
    heritage: Helm
    component: knox-service
spec:
  type: ClusterIP
  ports:
    - port: 8080
      protocol: TCP
  selector:
    app: apache-knox-helm
    chart: apache-knox-helm-0.1.10
    release: release-name
    heritage: Helm
    component: knox-deployment-pod
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: release-name-apache-knox-helm-dep
  labels:
    app: apache-knox-helm
    chart: apache-knox-helm-0.1.10
    release: release-name
    heritage: Helm
    component: knox-deployment
spec:
  selector:
    matchLabels:
      app: apache-knox-helm
      chart: apache-knox-helm-0.1.10
      release: release-name
      heritage: Helm
      component: knox-deployment-pod
  replicas: 1
  template:
    metadata:
      labels:
        app: apache-knox-helm
        chart: apache-knox-helm-0.1.10
        release: release-name
        heritage: Helm
        component: knox-deployment-pod
    spec:
      containers:
        - image: farberg/apache-knox-docker:1.6.1
          imagePullPolicy: IfNotPresent
          name: release-name-apache-knox-helm-pod
          ports:
            - containerPort: 8080
          volumeMounts:
            - name: release-name-apache-knox-helm-dep-config-volume
              mountPath: /opt/knox/conf/
      volumes:
        - name: release-name-apache-knox-helm-dep-config-volume
          configMap:
            name: release-name-apache-knox-helm-confmap
            items:
              - key: topologies-admin.xml
                path: topologies/admin.xml
              - key: topologies-knoxsso.xml
                path: topologies/knoxsso.xml
              - key: topologies-manager.xml
                path: topologies/manager.xml
              - key: topologies-sandbox.xml
                path: topologies/sandbox.xml
              - key: topologies-homepage.xml
                path: topologies/homepage.xml
              - key: topologies-metadata.xml
                path: topologies/metadata.xml
              - key: gateway-log4j.properties
                path: gateway-log4j.properties
              - key: gateway-site.xml
                path: gateway-site.xml
              - key: ldap-log4j.properties
                path: ldap-log4j.properties
              - key: knoxcli-log4j.properties
                path: knoxcli-log4j.properties
              - key: shell-log4j.properties
                path: shell-log4j.properties
              - key: users.ldif
                path: users.ldif
              - key: descriptors-README
                path: descriptors/README
